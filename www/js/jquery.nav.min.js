(function(d,b,a,e){var c=function(g,f){this.elem=g;this.$elem=d(g);this.options=f;this.metadata=this.$elem.data("plugin-options");this.$nav=this.$elem.find("a");this.$win=d(b);this.sections={};this.didScroll=false;this.$doc=d(a);this.docHeight=this.$doc.height()};c.prototype={defaults:{currentClass:"current",changeHash:false,easing:"swing",filter:"",scrollSpeed:750,scrollOffset:0,scrollThreshold:0.5,begin:false,end:false,scrollChange:false},init:function(){var f=this;f.config=d.extend({},f.defaults,f.options,f.metadata);if(f.config.filter!==""){f.$nav=f.$nav.filter(f.config.filter)}f.$nav.on("click.onePageNav",d.proxy(f.handleClick,f));f.getPositions();f.bindInterval();f.$win.on("resize.onePageNav",d.proxy(f.getPositions,f));return this},adjustNav:function(f,g){f.$elem.find("."+f.config.currentClass).removeClass(f.config.currentClass);g.addClass(f.config.currentClass)},bindInterval:function(){var f=this;var g;f.$win.on("scroll.onePageNav",function(){f.didScroll=true});f.t=setInterval(function(){g=f.$doc.height();if(f.didScroll){f.didScroll=false;f.scrollChange()}if(g!==f.docHeight){f.docHeight=g;f.getPositions()}},250)},getHash:function(f){return f.attr("href").split("#")[1]},getPositions:function(){var g=this;var i;var h;var f;g.$nav.each(function(){i=g.getHash(d(this));f=d("#"+i);if(f.length){h=f.offset().top;g.sections[i]=Math.round(h)-g.config.scrollOffset}})},getSection:function(i){var f=null;var h=Math.round(this.$win.height()*this.config.scrollThreshold);for(var g in this.sections){if((this.sections[g]-h)<i){f=g}}return f},handleClick:function(j){var g=this;var f=d(j.currentTarget);var i=f.parent();var h="#"+g.getHash(f);if(!i.hasClass(g.config.currentClass)){if(g.config.begin){g.config.begin()}g.adjustNav(g,i);g.unbindInterval();d.scrollTo(h,g.config.scrollSpeed,{axis:"y",easing:g.config.easing,offset:{top:-g.config.scrollOffset},onAfter:function(){if(g.config.changeHash){b.location.hash=h}g.bindInterval();if(g.config.end){g.config.end()}}})}j.preventDefault()},scrollChange:function(){var h=this.$win.scrollTop();var f=this.getSection(h);var g;if(f!==null){g=this.$elem.find('a[href$="#'+f+'"]').parent();if(!g.hasClass(this.config.currentClass)){this.adjustNav(this,g);if(this.config.scrollChange){this.config.scrollChange(g)}}}},unbindInterval:function(){clearInterval(this.t);this.$win.unbind("scroll.onePageNav")}};c.defaults=c.prototype.defaults;d.fn.onePageNav=function(f){return this.each(function(){new c(this,f).init()})}})(jQuery,window,document);